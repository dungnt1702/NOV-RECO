{% extends "base.html" %}
{% load static %}

{% block title %}Chỉnh sửa thông tin cá nhân{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/personal/edit.css' %}">
{% endblock %}

{% block content %}
<div class="personal-edit-page">
    <div class="container">
        <!-- Header -->
        <div class="edit-header">
            <div class="header-content">
                <h1 class="page-title">
                    <i class="fas fa-edit"></i> Chỉnh sửa thông tin cá nhân
                </h1>
                <p class="page-subtitle">Cập nhật thông tin cá nhân và công việc của bạn</p>
            </div>
            <div class="header-actions">
                <a href="{% url 'personal:profile' %}" class="btn btn-outline">
                    <i class="fas fa-arrow-left"></i> Quay lại
                </a>
            </div>
        </div>

        <!-- Edit Form -->
        <form method="post" enctype="multipart/form-data" class="edit-form">
            {% csrf_token %}
            
            <div class="form-sections">
                <!-- Thông tin cơ bản -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-user"></i> Thông tin cơ bản
                    </h3>
                    <div class="section-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="first_name">Họ *</label>
                                <input type="text" id="first_name" name="first_name" 
                                       value="{{ user.first_name }}" required>
                            </div>
                            <div class="form-group">
                                <label for="last_name">Tên *</label>
                                <input type="text" id="last_name" name="last_name" 
                                       value="{{ user.last_name }}" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="email">Email *</label>
                                <input type="email" id="email" name="email" 
                                       value="{{ user.email }}" required>
                            </div>
                            <div class="form-group">
                                <label for="phone">Số điện thoại</label>
                                <input type="tel" id="phone" name="phone" 
                                       value="{{ user.phone }}">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="date_of_birth">Ngày sinh</label>
                                <input type="date" id="date_of_birth" name="date_of_birth" 
                                       value="{{ user.date_of_birth|date:'Y-m-d' }}">
                            </div>
                            <div class="form-group">
                                <label for="gender">Giới tính</label>
                                <select id="gender" name="gender">
                                    <option value="">Chọn giới tính</option>
                                    {% for value, label in gender_choices %}
                                        <option value="{{ value }}" 
                                                {% if user.gender == value %}selected{% endif %}>
                                            {{ label }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="address">Địa chỉ thường trú</label>
                            <textarea id="address" name="address" rows="3" 
                                      placeholder="Nhập địa chỉ đầy đủ">{{ user.address }}</textarea>
                        </div>
                    </div>
                </div>

                <!-- Avatar -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-camera"></i> Ảnh đại diện
                    </h3>
                    <div class="section-content">
                        <div class="avatar-upload">
                            <div class="current-avatar">
                                {% if user.avatar %}
                                    <img src="{{ user.avatar.url }}" alt="Avatar hiện tại" class="avatar-preview">
                                {% else %}
                                    <div class="avatar-placeholder">
                                        <i class="fas fa-user"></i>
                                    </div>
                                {% endif %}
                            </div>
                            <div class="avatar-upload-controls">
                                <input type="file" id="avatar" name="avatar" accept="image/*" class="file-input">
                                <label for="avatar" class="btn btn-outline">
                                    <i class="fas fa-upload"></i> Chọn ảnh
                                </label>
                                <p class="upload-hint">JPG, PNG, GIF. Tối đa 5MB</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thông tin công việc -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-briefcase"></i> Thông tin công việc
                    </h3>
                    <div class="section-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="employee_id">Mã nhân viên</label>
                                <input type="text" id="employee_id" name="employee_id" 
                                       value="{{ user.employee_id }}" readonly>
                                <small class="form-hint">Mã nhân viên chỉ có thể thay đổi bởi Admin</small>
                            </div>
                            <div class="form-group">
                                <label for="position">Chức vụ</label>
                                <input type="text" id="position" name="position" 
                                       value="{{ user.position }}" placeholder="VD: Nhân viên kinh doanh">
                            </div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="skills">Kỹ năng chuyên môn</label>
                            <textarea id="skills" name="skills" rows="4" 
                                      placeholder="Liệt kê các kỹ năng chuyên môn của bạn">{{ user.skills }}</textarea>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="notes">Ghi chú thêm</label>
                            <textarea id="notes" name="notes" rows="3" 
                                      placeholder="Thông tin bổ sung về bản thân">{{ user.notes }}</textarea>
                        </div>
                    </div>
                </div>

                <!-- Thông tin liên hệ khẩn cấp -->
                <div class="form-section">
                    <h3 class="section-title">
                        <i class="fas fa-phone"></i> Liên hệ khẩn cấp
                    </h3>
                    <div class="section-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="emergency_contact">Người liên hệ</label>
                                <input type="text" id="emergency_contact" name="emergency_contact" 
                                       value="{{ user.emergency_contact }}" placeholder="Tên người liên hệ">
                            </div>
                            <div class="form-group">
                                <label for="emergency_phone">Số điện thoại</label>
                                <input type="tel" id="emergency_phone" name="emergency_phone" 
                                       value="{{ user.emergency_phone }}" placeholder="Số điện thoại liên hệ">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Lưu thay đổi
                </button>
                <a href="{% url 'personal:profile' %}" class="btn btn-outline">
                    <i class="fas fa-times"></i> Hủy
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/personal/edit.js' %}"></script>
{% endblock %}
