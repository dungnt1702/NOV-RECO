{% extends 'base.html' %}
{% load static %}

{% block title %}Import ngÆ°á»i dÃ¹ng - NOV-RECO{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/users/office_forms.css' %}">
{% endblock %}

{% block content %}
<div class="office-form-page">
  <div class="office-form-container">
    <div class="office-form-header">
      <h1>ğŸ“¥ Import ngÆ°á»i dÃ¹ng tá»« CSV (UTF-8)</h1>
      <p>Táº£i lÃªn file .csv (UTF-8, nÃªn cÃ³ BOM) vá»›i tiÃªu Ä‘á» cá»™t: username, first_name, last_name, email, role, employee_id, department_id</p>
    </div>

    {% if not has_openpyxl %}
      <div class="alert alert-warning" role="alert" style="margin-bottom: 16px;">
        MÃ¡y chá»§ chÆ°a cÃ i openpyxl, chá»‰ xem hÆ°á»›ng dáº«n. Vui lÃ²ng cÃ i Ä‘áº·t Ä‘á»ƒ dÃ¹ng import.
      </div>
    {% endif %}

    <div class="office-form-card">
      <form method="post" enctype="multipart/form-data" class="office-form">
        {% csrf_token %}
        <div class="office-form-group">
          <label class="office-form-label">Chá»n file Excel (.xlsx)</label>
          <input type="file" name="file" accept=".csv" class="office-form-input" required>
        </div>
        <div class="office-form-group">
          <label class="office-form-label">PhÃ²ng ban máº·c Ä‘á»‹nh (náº¿u file khÃ´ng cÃ³ department_id)</label>
          <select name="default_department" class="office-form-select">
            <option value="">(KhÃ´ng chá»n)</option>
            {% for dept in departments %}
              <option value="{{ dept.id }}">{{ dept.full_name }}</option>
            {% endfor %}
          </select>
          <div style="margin-top:8px;">
            <label style="display:flex;align-items:center;gap:8px;">
              <input type="checkbox" name="assign_default_department"> Tá»± Ä‘á»™ng gÃ¡n phÃ²ng ban máº·c Ä‘á»‹nh náº¿u thiáº¿u
            </label>
          </div>
        </div>

        <div class="office-form-actions" style="display:flex; gap:8px;">
          <button type="submit" class="office-form-btn">Import</button>
          <a href="{% url 'users:list' %}" class="office-form-btn" style="background:#64748b;">Quay láº¡i</a>
          <a href="{% url 'users:import_template' %}" class="office-form-btn" style="background:#334155;">Táº£i máº«u CSV</a>
        </div>
      </form>
    </div>

    <div class="office-form-card" style="margin-top:16px;">
      <h3 style="margin-bottom:8px;">HÆ°á»›ng dáº«n</h3>
      <div class="office-form-group">
        <ul style="color:#e2e8f0; line-height:1.8;">
          <li>LÆ°u file á»Ÿ Ä‘á»‹nh dáº¡ng CSV, mÃ£ hÃ³a UTF-8 (nÃªn cÃ³ BOM Ä‘á»ƒ Excel hiá»ƒn thá»‹ tiáº¿ng Viá»‡t Ä‘Ãºng).</li>
          <li>DÃ²ng Ä‘áº§u tiÃªn pháº£i lÃ  tiÃªu Ä‘á» cá»™t theo Ä‘Ãºng thá»© tá»±: <code>username, first_name, last_name, email, role, employee_id, department_id</code>.</li>
          <li><code>role</code> cháº¥p nháº­n: <code>super_admin</code>, <code>admin</code>, <code>manager</code>, <code>secretary</code>, <code>hr</code>, <code>employee</code>. Náº¿u trá»‘ng sáº½ máº·c Ä‘á»‹nh <code>employee</code>.</li>
          <li><code>department_id</code> lÃ  ID phÃ²ng ban. Náº¿u Ä‘á»ƒ trá»‘ng vÃ  báº¡n báº­t â€œTá»± Ä‘á»™ng gÃ¡n phÃ²ng ban máº·c Ä‘á»‹nh náº¿u thiáº¿uâ€, há»‡ thá»‘ng sáº½ dÃ¹ng phÃ²ng ban máº·c Ä‘á»‹nh báº¡n chá»n.</li>
          <li>Khuyáº¿n nghá»‹: Táº£i máº«u CSV Ä‘á»ƒ Ä‘iá»n cho Ä‘Ãºng Ä‘á»‹nh dáº¡ng.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}


