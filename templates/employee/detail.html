{% extends 'base.html' %}
{% load static %}

{% block title %}Chi tiết Nhân viên - {{ employee.get_display_name }} - NOV-RECO{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/employee/detail.css' %}">
{% endblock %}

{% block content %}
<div class="employee-detail-page">
    <div class="employee-detail-container">
        <div class="employee-detail-header">
            <div class="employee-avatar">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="employee-info">
                <h1 class="employee-name">{{ employee.get_display_name }}</h1>
                <p class="employee-role">{{ employee.get_role_display }}</p>
                <p class="employee-department">
                    {% if employee.department %}
                        <i class="fas fa-building"></i> {{ employee.department.name }}
                    {% else %}
                        <i class="fas fa-exclamation-triangle"></i> Chưa phân phòng ban
                    {% endif %}
                </p>
            </div>
            <div class="employee-actions">
                <a href="{% url 'employee:edit' employee.id %}" class="btn btn-primary">
                    <i class="fas fa-edit"></i> Chỉnh sửa
                </a>
                <a href="{% url 'employee:list' %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Quay lại
                </a>
            </div>
        </div>

        <div class="employee-detail-content">
            <div class="detail-grid">
                <!-- Personal Information -->
                <div class="detail-section">
                    <h3><i class="fas fa-user"></i> Thông tin Cá nhân</h3>
                    <div class="info-list">
                        <div class="info-item">
                            <label>Tên đăng nhập:</label>
                            <span>{{ employee.username }}</span>
                        </div>
                        <div class="info-item">
                            <label>Email:</label>
                            <span>{{ employee.email }}</span>
                        </div>
                        <div class="info-item">
                            <label>Họ tên:</label>
                            <span>{{ employee.get_full_name }}</span>
                        </div>
                        <div class="info-item">
                            <label>Số điện thoại:</label>
                            <span>{{ employee.phone|default:"Chưa cập nhật" }}</span>
                        </div>
                        <div class="info-item">
                            <label>Mã nhân viên:</label>
                            <span>{{ employee.employee_id|default:"Chưa có mã NV" }}</span>
                        </div>
                        <div class="info-item">
                            <label>Ngày tham gia:</label>
                            <span>{{ employee.date_joined|date:"d/m/Y H:i" }}</span>
                        </div>
                        <div class="info-item">
                            <label>Đăng nhập cuối:</label>
                            <span>
                                {% if employee.last_login %}
                                    {{ employee.last_login|date:"d/m/Y H:i" }}
                                {% else %}
                                    Chưa đăng nhập
                                {% endif %}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Work Information -->
                <div class="detail-section">
                    <h3><i class="fas fa-briefcase"></i> Thông tin Công việc</h3>
                    <div class="info-list">
                        <div class="info-item">
                            <label>Vai trò:</label>
                            <span class="role-badge role-{{ employee.role }}">
                                {{ employee.get_role_display }}
                            </span>
                        </div>
                        <div class="info-item">
                            <label>Phòng ban:</label>
                            <span>
                                {% if employee.department %}
                                    {{ employee.department.name }}
                                {% else %}
                                    Chưa phân phòng ban
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <label>Trạng thái:</label>
                            <span class="status-badge status-{{ employee.is_active|yesno:'active,inactive' }}">
                                {% if employee.is_active %}
                                    <i class="fas fa-check-circle"></i> Hoạt động
                                {% else %}
                                    <i class="fas fa-times-circle"></i> Tạm dừng
                                {% endif %}
                            </span>
                        </div>
                        <div class="info-item">
                            <label>Quyền admin:</label>
                            <span class="status-badge status-{{ employee.is_staff|yesno:'active,inactive' }}">
                                {% if employee.is_staff %}
                                    <i class="fas fa-check-circle"></i> Có
                                {% else %}
                                    <i class="fas fa-times-circle"></i> Không
                                {% endif %}
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Check-ins -->
            <div class="detail-section">
                <h3><i class="fas fa-history"></i> Check-in Gần đây</h3>
                {% if checkins %}
                    <div class="checkin-list">
                        {% for checkin in checkins %}
                        <div class="checkin-item">
                            <div class="checkin-time">
                                {{ checkin.created_at|date:"d/m/Y H:i" }}
                            </div>
                            <div class="checkin-location">
                                <i class="fas fa-map-marker-alt"></i> {{ checkin.area.name }}
                            </div>
                            <div class="checkin-coordinates">
                                {{ checkin.lat|floatformat:6 }}, {{ checkin.lng|floatformat:6 }}
                            </div>
                            {% if checkin.note %}
                            <div class="checkin-note">
                                <i class="fas fa-sticky-note"></i> {{ checkin.note }}
                            </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <p>Chưa có check-in nào</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/employee/detail.js' %}"></script>
{% endblock %}
